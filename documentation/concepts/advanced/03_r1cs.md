---
id: r1cs
title: R1CS
sidebar_label: R1CS
---

Aleo 仮想マシンは、回路の中間表現として「ランク 1 制約システム（Rank-1 Constrained System, R1CS）」を利用します。この形式を使うと、計算を後で形式的に検証できる連立方程式として表現できます。

## **R1CS の定義と構造**

R1CS は、本質的には計算問題を表現するために構成された、体上の線形方程式の集合です。R1CS における各制約は次の形の方程式になります。

$$
(a_0+a_1x_1+...+a_nx_n)(b_0+b_1y_1+...+b_my_m) = (c_0+c_1z_1+...+c_lz_l)
$$

ここで $x_i, y_j, z_k$ は変数、$a_i, b_j, c_k$ は与えられた体の定数です。これらの制約は、変数が左辺を満たすなら右辺も満たさなければならないよう設計されています。詳細は [**Schwartz-Zippel の補題**](https://en.wikipedia.org/wiki/Schwartz%E2%80%93Zippel_lemma) を参照してください。

## **AVM における R1CS の流れ**

### **回路生成**

1. **Leo** プログラムは AVM が理解できるアセンブリに似た言語「**Aleo instruction**」へコンパイルされます。
2. **Aleo instruction** は R1CS の回路表現へコンパイルされます。
3. **R1CS 回路** はエクスポートされ、必要に応じてネットワークへデプロイされます。

### **証明生成**

プログラムが R1CS として表現されると、Aleo はこの表現を使ってゼロ知識証明を生成します。この証明によって、プログラムを実行した証明者は、計算の具体的な入力や内部状態を開示することなく、検証者（Aleo の検証ノードネットワーク）に正しくロジックを実行したことを納得させられます。

### **検証**

検証者は証明と公開出力（あれば）だけを受け取り、R1CS 回路に照らし合わせて計算が正しく行われたかを確認します。この検証プロセスでは計算の詳細を知る必要がないため、プライバシーが保たれます。

---
