---
id: accounts
title: アカウント
sidebar_label: アカウント
---

**Aleo アカウント**は、[アカウント秘密鍵](#account-private-key)、[アカウントビューキー](#account-view-key)、そして[アカウントアドレス](#account-address)で構成されます。

アカウント秘密鍵はトランザクションの署名に使用され、アカウントレコードのグローバルステートを更新します。アカウントビューキーは、ユーザーのアカウントアドレスで暗号化されているアカウントレコードを復号するために利用します。最後に、アカウントアドレスは、値やアプリケーションデータをエンコードしたレコードを送受信する際の識別子として機能します。

ユーザーの*資産*と*レコードデータ*を守るため、**アカウント秘密鍵は第三者に絶対に開示してはいけません**。実運用の Aleo アプリケーションでは、アカウント秘密鍵からコンピュートキーを導出し、第三者が信用を前提とせずにアプリケーションを実行したり、ユーザーに代わってトランザクションを生成したりできるようにします。

新しい Aleo アカウントは[こちら](https://provable.tools)で生成できます。

## アカウント秘密鍵

アカウント秘密鍵は、ランダムにサンプリングした**アカウントシード**から構成されます。このアカウントシードから以下を生成します。
- アカウント署名方式の**秘密鍵**
- トランザクションシリアルナンバー用の**疑似乱数関数シード**
- アカウントコミットメント方式のための**コミットメント乱数**

### 秘密鍵フォーマット

```
APrivateKey1zkp4X9ApjTb7Rv8EABfZRugXBhbPzCL245GyNtYJP5GYY2k
```

アカウント秘密鍵は 59 文字で構成される Base58 形式の文字列です。
[鍵プレフィックス](#account-prefixes)として `APrivateKey1` が付与されており、秘密鍵であることと他者と共有すべきでないことを示します。

## アカウントビューキー

Aleo のアカウントビューキーはアカウント秘密鍵から導出され、グローバルレジャー上に保存された自分の[レコード](02_records.md)を復号するために使用します。
ビューキーによってアカウント内のすべてのレコードにアクセスできるため、第三者の監査人がアカウントの完全な履歴を検証する用途にも利用できます。

アカウントビューキーは以下で構成されます。
- アカウント暗号化方式用の**秘密鍵**

### ビューキーフォーマット

```
AViewKey1nKB4qr9b5gK8wQvmM5sTPEuBwshtDdkCZB1SPWppAG9Y
```

アカウントビューキーは 53 文字で構成される Base58 形式の文字列です。
ビューキーには `[ビューキープレフィックス](#account-prefixes)`として `AViewKey1` が付与されており、正当な相手にのみ共有すべきキーであることを示します。

## アカウントアドレス

Aleo のアカウントアドレスは、ユーザー同士がトランザクションで価値やレコードデータをやり取りするための一意の識別子です。

アカウントアドレスは以下で構成されます。
- アカウント暗号化方式の**公開鍵**

### アドレスフォーマット

```
aleo1dg722m22fzpz6xjdrvl9tzu5t68zmypj5p74khlqcac0gvednygqxaax0j
```

アカウントアドレスは 63 文字で構成される Bech32 形式の文字列です。
アドレスには `[アカウントプレフィックス](#account-prefixes)`として `aleo1` が付与されています。

## 発展トピック

以下のアルゴリズムの説明では、次の数学的オブジェクトの定義を使用します。

### 素数体

素数 `r` に対して、位数 `r` の素数体は整数集合 `{0, 1, ..., r - 1}` に対し、加算と乗算を法 `r` で定義したものです。
本ドキュメントでは以下の 2 つの素数体を使用します。
* 素数 `p = 2111115437357092606062206234695386632838870926408408195193685246394721360383` を位数に持つ <code>F<sub>scalar</sub></code>
* 素数 `q = 8444461749428370424248824938781546531375899335154063827935233455917409239041` を位数に持つ <code>F<sub>base</sub></code>

### 素数位の楕円曲線群

本ドキュメントでは、<code>F<sub>base</sub></code> 上で定義された楕円曲線のうち、位数 `p` の部分群を考えます。  

この部分群の要素は座標ペア `(x, y)` で表されます。群には点の加算および倍算という 2 つの演算が定義されています。また、群には特別な点である**生成元** `G` が存在します。

### HashToField

有限体 `F` に対して、HashToField はバイト列または体要素の列を入力とし、体 `F` の要素を出力する暗号学的ハッシュ関数です。出力は体 `F` 上で一様に分布します。

### HashToScalar
<!-- markdown-link-check-disable -->
<code>F<sub>scalar</sub></code> 上の要素を出力する HashToField の具体的な実装です。
[ソースコード](https://github.com/ProvableHQ/snarkVM/blob/mainnet/console/algorithms/src/poseidon/hash_to_scalar.rs)
<!-- markdown-link-check-enable -->

### EncodeToF

EncodeToF(x) は、Unicode 文字列 `x` を <code>F<sub>base</sub></code> の要素へエンコードする関数です。

エンコードの詳細:
- `x` を UTF-8 のバイト列 `b` に変換します。
- `b` をリトルエンディアンとして解釈した符号なし整数 `v` へ変換します。
- `v` を <code>F<sub>base</sub></code> を定義する素数で剰余を取ります。

### アカウントプレフィックス

|                         |  型  | ヒューマンリーダブルプレフィックス |                       プレフィックスのバイト列                        |
|:-----------------------:|:------:|:---------------------:|:---------------------------------------------------------:|
| **アカウント秘密鍵** | bytes  | `APrivateKey1`        | `[127, 134, 189, 116, 210, 221, 210, 137, 145, 18, 253]`  |
| **アカウントビューキー**    | bytes  | `AViewKey1`           | `[ 14, 138, 223, 204, 247, 224, 122 ]`                    |
| **アカウントアドレス**     | string | `aleo1`               | `aleo1`                                                   |

### オフラインアカウント

企業環境など多くのケースで、機微な鍵やデータは隔離されたオフライン環境で扱うことが推奨されます。
Aleo アカウントはオフラインマシン上で作成でき、すぐに利用可能です。アカウントの証明鍵と組み合わせれば、トランザクション作成時であっても秘密鍵をオフラインのまま保持できます。

完璧な解決策は存在しませんが、意図しない第三者にアカウント秘密鍵が漏洩するリスクを最小化するためにも、接続されていないデバイスで新しい Aleo アカウントを作成することを推奨します。

### アカウントコミットメント出力

アカウントコミットメント出力はアカウントビューキーを生成する際に使用され、暗号化秘密鍵で構成されます。
この暗号化秘密鍵はアカウントコミットメント出力から導出されたスカラー体の要素です。ビューキーの正当性を担保するため、アカウントコミットメント出力はスカラー体で表現可能である必要があります。

### アカウントの作成

グローバルに初期化された Aleo パラメーターとサブルーチンが与えられているとします。

#### 秘密鍵の生成

1. 32 バイトの `seed` をランダムにサンプリングする

2. 秘密鍵の構成要素を生成する
    - `sk_sig` = HashToScalar(EncodeToF("AleoAccountSignatureSecretKey0") || `seed`)
    - `r_sig` = HashToScalar(EncodeToF("AleoAccountSignatureRandomizer0.0") || `seed`)

    ここで、`||` は連結を表し、`HashToScalar` は入力レート 2 の [Poseidon ハッシュ関数](https://eprint.iacr.org/2019/458.pdf)を指します。`seed` はハッシュ処理の前に `Field` 型へ変換します。

3. `private_key` = (`seed`, (`sk_sig`, `r_sig`))

#### ビューキーの生成
1. `(sk_sig, r_sig)` = `private_key`
2. `view_key` = `sk_sig` + `r_sig` + HashToScalar(`sk_sig` * `G` || `r_sig` * `G`)

ここで `G` はベースフィールドの生成元であり、入力ドメインメッセージを曲線上の点へハッシュし、スカラー体のビットサイズまで倍算を繰り返すことで得られる楕円曲線群要素のベクトルです。`+` はスカラー加算を表します。

#### アドレスの生成

1. `address` = `view_key` * `G`
